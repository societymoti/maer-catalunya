<!DOCTYPE html>
<html lang="ca">
<head>
    <link rel="icon" type="image/png" href="https://i.imgur.com/TW3DnOz.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MAER CATALUNYA</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
            touch-action: manipulation;
        }
        #map {
            width: 100vw;
            height: calc(100vh - 50px);
        }
        h1 {
            margin: 0;
            padding: 13px;
            background: #c01717;
            color: white;
            text-align: center;
            font-size: 1.1em;
            position: relative;
            z-index: 1000;
        }
        .update-box {
            position: absolute;
            top: 12px;
            left: 8px;
            background: white;
            color: #2c3e50;
            padding: 4px 7px;
            font-size: 0.7em;
            border-radius: 10px;
            box-shadow: 0 2px 2px rgba(0,0,0,0.2);
        }
        .helicopter-label {
            text-align: center;
            font-weight: bold;
            margin-top: 0px;
            color: #2c3e50;
        }
        .helicopter-subtext {
            color: #000;
            margin-top: -4px;
            font-weight: bold;
        }
        .leaflet-control-layers {
            background: rgba(255, 255, 255, 0.95);
            padding: 5px;
            border-radius: 5px;
            font-size: 0.9em;
            max-height: 40px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .leaflet-control-layers-expanded {
            max-height: 300px;
            overflow-y: auto;
            padding: 12px;
        }
        .leaflet-control-layers-toggle {
            width: 30px;
            height: 30px;
            background-size: 20px;
        }
        .leaflet-control-info-toggle {
            background: rgba(255, 255, 255, 0.9);
            padding: 9px 12px;
            border-radius: 10px;
            font-size: 0.9em;
            color: #2c3e50;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .leaflet-control-info-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.85em;
            color: #2c3e50;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
            margin-top: 5px;
            display: none;
            width: 250px;
            max-height: 520px;
            overflow-y: auto;
            scrollbar-width: none;
        }
        .leaflet-control-info-box::-webkit-scrollbar {
            width: 5px;
        }
        .leaflet-control-info-box::-webkit-scrollbar-thumb {
            background-color: rgba(0,0,0,0.2);
            border-radius: 3px;
        }
        .watermark {
            position: absolute;
            bottom: 5px;
            right: 10px;
            z-index: 999;
            text-align: center;
            opacity: 0.55;
        }
        .watermark img {
            width: 65px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .watermark span {
            font-size: 0.5em;
            color: #2c3e50;
            font-weight: bold;
            user-select: none;
        }
        .leaflet-control-attribution {
            display: none !important;
        }
        .info-title {
            font-weight: bold;
            margin-bottom: 6px;
            color: #c01717;
            text-align: center;
            font-size: 1em;
        }
        .info-section {
            margin-bottom: 8px;
        }
        .info-section-title {
            font-weight: bold;
            margin: 4px 0;
            color: #2c3e50;
            font-size: 0.95em;
        }
        .info-list {
            margin: 4px 0;
            padding-left: 12px;
            font-size: 0.9em;
        }
        .info-list li {
            margin-bottom: 3px;
        }
        .creator-text {
            opacity: 0.5;
            font-size: 0.95em;
            text-align: center;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            #map {
                height: calc(100vh - 45px);
            }

            h1 {
                padding: 8px 8px 8px 35px;
                font-size: 1em;
            }

            .update-box {
                top: 6px;
                left: 6px;
                padding: 2px 5px;
                font-size: 0.65em;
            }

            .watermark img {
                width: 50px;
            }

            .leaflet-control-layers {
                max-width: 40px;
                max-height: 40px;
            }

            .leaflet-control-layers-expanded {
                max-width: 200px;
                max-height: 250px;
            }
        }
    </style>
</head>
<body>
    <h1>
        MAER CATALUNYA
        <div class="update-box">Actualitzat el 12/08/25</div>
    </h1>
    <div id="map"></div>

    <div class="watermark">
        <a href="https://transitaeri.cat/" target="_blank" title="Trànsit Aeri de Catalunya">
            <img src="https://i.imgur.com/ZDgCuIz.png" alt="Logo Trànsit Aeri">
        </a>
        <span>©2025 Trànsit Aeri de Catalunya</span>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        const map = L.map('map').setView([41.7, 1.4], 8);

        L.tileLayer('https://geoserveis.icgc.cat/servei/catalunya/mapa-base/wmts/topografic/MON3857NW/{z}/{x}/{y}.png', {
            attribution: ''
        }).addTo(map);

        const capaSEM = L.layerGroup().addTo(map);
        const capaBombers = L.layerGroup().addTo(map);
        const capaBombarders = L.layerGroup().addTo(map);
        const capaAVA = L.layerGroup().addTo(map);
        const capaComandament = L.layerGroup().addTo(map);
        const capaMossos = L.layerGroup().addTo(map);
        const capaRurals = L.layerGroup().addTo(map);
        const capaSalvament = L.layerGroup().addTo(map);
        const capaTransit = L.layerGroup().addTo(map);

        const capaMap = {
            "HEMS": capaSEM,
            "BOMBERS": capaBombers,
            "BOMBARDERS": capaBombarders,
            "AVA": capaAVA,
            "COMANDAMENT": capaComandament,
            "MOSSOS": capaMossos,
            "RURALS": capaRurals,
            "SALVAMENT": capaSalvament,
            "TRANSIT": capaTransit,
        };

        const helicopterImages = {
            "EC-MMP": "https://i.imgur.com/MsKnz8V.png",
            "EC-NRL": "https://i.imgur.com/Ve0Ju6e.png",
            "EC-NRK": "https://i.imgur.com/Ve0Ju6e.png",
            "EC-KDA": "https://i.imgur.com/Ve0Ju6e.png",
            "OE-XSD": "https://i.imgur.com/OZ6E26W.png",
            "EC-NOT": "https://i.imgur.com/LAEOuAn.png",
            "EC-MZR": "https://i.imgur.com/zMi2DrJ.png",
            "EC-MIC": "https://i.imgur.com/LIw2p1I.png",
            "SE-JLN": "https://i.imgur.com/V9ZUIIv.png",
            "EC-LZY": "https://i.imgur.com/uyBQIdn.png",
            "EC-KIE": "https://i.imgur.com/uyBQIdn.png",
            "EC-KZL": "https://i.imgur.com/uyBQIdn.png",
            "EC-NKD": "https://i.imgur.com/uyBQIdn.png",
            "EC-NDU": "https://i.imgur.com/2iySlxO.png",
            "EC-NSI": "https://i.imgur.com/grN5wh9.png",
            "EC-JVS": "https://i.imgur.com/grN5wh9.png",
            "EC-NZU": "https://i.imgur.com/R4ma3RX.png",
            "EC-MZL": "https://i.imgur.com/2iySlxO.png",
            "SE-JXP": "https://i.imgur.com/V9ZUIIv.png",
            "EC-HIL": "https://i.imgur.com/V9ZUIIv.png",
            "EC-HHT": "https://i.imgur.com/V9ZUIIv.png",
            "SE-JTS": "https://i.imgur.com/V9ZUIIv.png",
            "SE-JUB": "https://i.imgur.com/V9ZUIIv.png",
            "EC-MQR": "https://i.imgur.com/uyBQIdn.png",
            "EC-LYC": "https://i.imgur.com/uyBQIdn.png",
            "EC-LXS": "https://i.imgur.com/uyBQIdn.png",
            "EC-NFY": "https://i.imgur.com/uyBQIdn.png",
            "EC-KFO": "https://i.imgur.com/MYL6sdZ.png",
            "EC-NXN": "https://i.imgur.com/uyBQIdn.png",
            "EC-MBQ": "https://i.imgur.com/uyBQIdn.png",
            "EC-MHK": "https://i.imgur.com/LIw2p1I.png",
            "EC-LSC": "https://i.imgur.com/LIw2p1I.png",
            "EC-NES": "https://i.imgur.com/R2dMQ3R.png",
            "EC-NET": "https://i.imgur.com/R2dMQ3R.png",
            "EC-KLV": "https://i.imgur.com/xbR3jpq.png",
            "EC-FOQ": "https://i.imgur.com/i6AnX3C.png",
            "EC-IOP": "https://i.imgur.com/rBCM0vo.png",
            "EC-LHD": "https://i.imgur.com/Pex61Ef.png",
            "EC-IQC": "https://i.imgur.com/BgQ9p7E.png",
            "EC-KVH": "https://i.imgur.com/hzm1VhF.png",
        };

        const defaultImg = "https://i.imgur.com/U8Tl9ZD.png";

        // Objecte amb els noms de les ubicacions
        const ubicacions = {
            "EC-MMP": "Hospital Taulí Sabadell",
            "EC-NRL": "Hospital Trueta Girona",
            "EC-NRK": "Parc de Bombers Tremp",
            "EC-KDA": "Parc de Bombers Móra Ebre",
            "OE-XSD": "Aeroport de Sabadell",
            "EC-NOT": "Aeroport de La Seu d'Urgell",
            "EC-MZR": "Parc de bombers Olot",
            "EC-MIC": "Aeròdrom d'Igualada-Odena",
            "EC-NDU": "Aeroport de Sabadell",
            "EC-MZL": "Aeroport de Sabadell",
            "SE-JLN": "Parc de Bombers de Lleida",
            "EC-LZY": "Aeroport de Lleida-Alguaire",
            "EC-KIE": "Aeroport de Sabadell",
            "EC-KZL": "Horta de Sant Joan Parc de Bombers",
            "EC-NKD": "Aeròdrom d'Igualada-Odena",
            "EC-NZU": "Aeroport de Sabadell",
            "EC-JVS": "Aeroport de Sabadell",
            "EC-NSI": "Aeroport de Sabadell",
            "SE-JXP": "Parc de Bombers de Manresa",
            "EC-HIL": "Hospital Trueta Girona",
            "EC-HHT": "Heliport d'Ullastrell",
            "SE-JUB": "112 Reus",
            "SE-JTS": "Aeroport de Sabadell",
            "EC-MQR": "Aeròdrom de Moià",
            "EC-LYC": "Aerodrom d'Ordís",
            "EC-LXS": "Heliport Costa Brava",
            "EC-NFY": "Aeroport de La Seu d'Urgell",
            "EC-KFO": "Heliport de Vielha",
            "EC-NXN": "Aerodrom St.Feliu Buixalleu",
            "EC-MBQ": "Parc de Bombers de Prades",
            "EC-MHK": "Aeroport de Lleida-Alguaire",
            "EC-LSC": "Aeròdrom d'Igualada-Odena",
            "EC-NES": "Aerodrom d'Empuriabrava",
            "EC-NET": "Aerodrom d'Empuriabrava",
            "EC-KLV": "Aeroport de Reus",
            "EC-FOQ": "Aeroport de Sabadell",
            "EC-IOP": "Aeroport de Sabadell",
            "EC-LHD": "Heliport del Port de Barcelona",
            "EC-IQC": "Aeroport de Reus",
            "EC-KVH": "Aeroport de Sabadell",
        };

        // Objecte amb els tipus d'aeronau
        const tipusAeronau = {
            "EC-MMP": "Airbus H145",
            "EC-NRL": "Airbus H135",
            "EC-NRK": "Airbus H135",
            "EC-KDA": "Airbus H135",
            "OE-XSD": "Airbus H135",
            "EC-NOT": "Bell B429",
            "EC-MZR": "Airbus H135",
            "EC-MIC": "Air Tractor AT-802A",
            "EC-NDU": "Air Tractor AT-802F",
            "EC-MZL": "Air Tractor AT-802F",
            "SE-JLN": "Airbus H120",
            "EC-LZY": "Airbus H125",
            "EC-KIE": "Airbus H125",
            "EC-KZL": "Airbus H125",
            "EC-NKD": "Airbus H125",
            "EC-NZU": "Airbus H125",
            "EC-JVS": "Airbus H135",
            "EC-NSI": "Airbus H135",
            "SE-JXP": "Airbus H120",
            "EC-HIL": "Airbus H120",
            "EC-HHT": "Airbus H120",
            "SE-JTS": "Airbus H120",
            "SE-JUB": "Airbus H120",
            "EC-MQR": "Airbus H125",
            "EC-LYC": "Airbus H125",
            "EC-LXS": "Airbus H125",
            "EC-NFY": "Airbus H125",
            "EC-KFO": "Airbus H125",
            "EC-NXN": "Airbus H125",
            "EC-MBQ": "Airbus H125",
            "EC-MHK": "Air Tractor AT-802A",
            "EC-LSC": "Air Tractor AT-802A",
            "EC-NES": "Trush S2R-T660",
            "EC-NET": "Trush S2R-T660",
            "EC-KLV": "Leonardo AW139",
            "EC-FOQ": "Airbus H125",
            "EC-IOP": "Vulcanair P68",
            "EC-LHD": "Eurocopter AS355",
            "EC-IQC": "Air Tractor AT-802F",
            "EC-KVH": "Airbus H145",
        };

        const helicopterPositions = [
            { lat: 41.5580, lon: 2.1087, codi: "EC-MMP", tipo: 'HEMS', subtext: "H1" },
            { lat: 41.9977, lon: 2.8210, codi: "EC-NRL", tipo: 'HEMS', subtext: "H2" },
            { lat: 42.1645, lon: 0.8894, codi: "EC-NRK", tipo: 'HEMS', subtext: "H3" },
            { lat: 41.0865, lon: 0.6299, codi: "EC-KDA", tipo: 'HEMS', subtext: "H4" },
            { lat: 41.5186, lon: 2.1059, codi: "OE-XSD", tipo: 'BOMBERS', subtext: "50.03" },
            { lat: 41.5197, lon: 2.1043, codi: "EC-KVH", tipo: 'BOMBERS', subtext: "50.06" },
            { lat: 42.3380, lon: 1.4033, codi: "EC-NOT", tipo: 'BOMBERS', subtext: "50.04" },
            { lat: 42.1902, lon: 2.4750, codi: "EC-MZR", tipo: 'BOMBERS', subtext: "50.05" },
            { lat: 41.5889, lon: 1.6507, codi: "EC-MIC", tipo: 'AVA', subtext: "50.82" },
            { lat: 41.5179, lon: 2.1064, codi: "EC-NDU", tipo: 'AVA', subtext: "50.81" },
            { lat: 41.5176, lon: 2.1073, codi: "EC-MZL", tipo: 'AVA', subtext: "50.83" },
            { lat: 41.6240, lon: 0.6045, codi: "SE-JLN", tipo: 'COMANDAMENT', subtext: "50.30" },
            { lat: 41.7236, lon: 0.5403, codi: "EC-LZY", tipo: 'BOMBARDERS', subtext: "50.31" },
            { lat: 41.5208, lon: 2.1028, codi: "EC-KIE", tipo: 'BOMBARDERS', subtext: "50.41" },
            { lat: 40.9482, lon: 0.3206, codi: "EC-KZL", tipo: 'BOMBARDERS', subtext: "50.71" },
            { lat: 41.5863, lon: 1.6523, codi: "EC-NKD", tipo: 'BOMBARDERS', subtext: "50.51" },
            { lat: 41.5221, lon: 2.1072, codi: "EC-NZU", tipo: 'RURALS', subtext: "" },
            { lat: 41.5231, lon: 2.1052, codi: "EC-JVS", tipo: 'MOSSOS', subtext: "Helix 01" },
            { lat: 41.5241, lon: 2.1033, codi: "EC-NSI", tipo: 'MOSSOS', subtext: "Helix 02" },
            { lat: 41.7418, lon: 1.8522, codi: "SE-JXP", tipo: 'COMANDAMENT', subtext: "50.10" },
            { lat: 41.9973, lon: 2.8210, codi: "EC-HIL", tipo: 'COMANDAMENT', subtext: "50.20" },
            { lat: 41.5249, lon: 1.9713, codi: "EC-HHT", tipo: 'COMANDAMENT', subtext: "50.40" },
            { lat: 41.1337, lon: 1.1873, codi: "SE-JUB", tipo: 'COMANDAMENT', subtext: "50.60" },
            { lat: 41.5222, lon: 2.1009, codi: "SE-JTS", tipo: 'COMANDAMENT', subtext: "50.90" },
            { lat: 41.8022, lon: 2.1124, codi: "EC-MQR", tipo: 'BOMBARDERS', subtext: "50.11" },
            { lat: 42.2329, lon: 2.8850, codi: "EC-LYC", tipo: 'BOMBARDERS', subtext: "50.21" },
            { lat: 41.8069, lon: 3.0364, codi: "EC-LXS", tipo: 'BOMBARDERS', subtext: "50.22" },
            { lat: 42.3387, lon: 1.4041, codi: "EC-NFY", tipo: 'BOMBARDERS', subtext: "50.32" },
            { lat: 42.6969, lon: 0.8022, codi: "EC-KFO", tipo: 'BOMBARDERS', subtext: "50.38" },
            { lat: 41.7502, lon: 2.6114, codi: "EC-NXN", tipo: 'BOMBARDERS', subtext: "50.42" },
            { lat: 41.3119, lon: 0.9871, codi: "EC-MBQ", tipo: 'BOMBARDERS', subtext: "50.61" },
            { lat: 41.7297, lon: 0.5403, codi: "EC-MHK", tipo: 'AVA', subtext: "50.86" },
            { lat: 41.5886, lon: 1.6520, codi: "EC-LSC", tipo: 'AVA', subtext: "50.84" },
            { lat: 42.2612, lon: 3.1085, codi: "EC-NES", tipo: 'AVA', subtext: "TZ7" },
            { lat: 42.2624, lon: 3.1084, codi: "EC-NET", tipo: 'AVA', subtext: "TZ6" },
            { lat: 41.1438, lon: 1.1504, codi: "EC-KLV", tipo: 'SALVAMENT', subtext: "Helimer 207" },
            { lat: 41.5177, lon: 2.1107, codi: "EC-FOQ", tipo: 'TRANSIT', subtext: "Trànsit 04" },
            { lat: 41.5172, lon: 2.1087, codi: "EC-IOP", tipo: 'TRANSIT', subtext: "Trànsit 81" },
            { lat: 41.3643, lon: 2.1830, codi: "EC-LHD", tipo: 'TRANSIT', subtext: "Trànsit 07" },
            { lat: 41.1491, lon: 1.1637, codi: "EC-IQC", tipo: 'AVA', subtext: "AZ0" },
        ];

        function crearHelicopter({ lat, lon, codi, tipo, subtext }, zoomLevel) {
            // Detectar si es móvil
            const isMobile = window.innerWidth <= 768;

            // Ajustar el factor de escala (más grande en escritorio)
            const baseScale = isMobile ? 0.9 : 1.2;

            // Factor d'escala basat en el zoom (8% d'augment per nivell sobre 8)
            const scaleFactor = (zoomLevel > 8 ? 1 + (zoomLevel - 8) * 0.08 : 1) * baseScale;

            // Calcula les noves mides basades en el factor d'escala
            const iconWidth = isMobile ? 60 * scaleFactor : 70 * scaleFactor;
            const labelFontSize = isMobile ? 0.6 * scaleFactor : 0.7 * scaleFactor;
            const subtextFontSize = isMobile ? 0.7 * scaleFactor : 0.8 * scaleFactor;

            const imgSrc = helicopterImages[codi] || defaultImg;
            const iconHtml = `
                <div style="text-align: center;">
                    <img src="${imgSrc}" style="width: ${iconWidth}px; height: auto;">
                    <div class="helicopter-label" style="font-size: ${labelFontSize}em">${codi}</div>
                    <div class="helicopter-subtext" style="font-size: ${subtextFontSize}em">${subtext}</div>
                </div>`;
            const customIcon = L.divIcon({
                html: iconHtml,
                iconSize: [isMobile ? 70 * scaleFactor : 80 * scaleFactor, isMobile ? 45 * scaleFactor : 55 * scaleFactor],
                className: 'custom-icon'
            });

            // Obtenir les dades de ubicació i tipus d'aeronau
            const ubicacio = ubicacions[codi] || "Ubicació desconeguda";
            const aeronau = tipusAeronau[codi] || "Tipus desconegut";

            return L.marker([lat, lon], { icon: customIcon }).bindPopup(`
                <b>Matrícula:</b> ${codi}<br>
                <b>Codi:</b> ${subtext}<br>
                <b>Ubicació:</b> ${ubicacio}<br>
                <b>Tipus d'Aeronau:</b> ${aeronau}<br>
                <b>Funció:</b> ${tipo}
            `);
        }

        // Funció per actualitzar tots els marcadors amb el zoom actual
        function actualitzarHelicopters() {
            const zoomActual = map.getZoom();

            // Eliminem tots els marcadors existents
            Object.values(capaMap).forEach(capa => capa.clearLayers());

            // Tornem a crear tots els helicòpters amb el nou zoom
            helicopterPositions.forEach(pos => {
                const marker = crearHelicopter(pos, zoomActual);
                marker.addTo(capaMap[pos.tipo] || capaSEM);
            });
        }

        // Escoltem els canvis de zoom
        map.on('zoomend', actualitzarHelicopters);

        // Creem els helicòpters inicials amb el zoom per defecte (8)
        helicopterPositions.forEach(pos => {
            crearHelicopter(pos, 8).addTo(capaMap[pos.tipo] || capaSEM);
        });

        const capesDisponibles = {
            "<i class='fas fa-briefcase-medical'></i> SEM (HEMS)": capaSEM,
            "<i class='fas fa-child'></i> Rescat Bombers": capaBombers,
            "<i class='fas fa-fire-alt'></i> Bombarders": capaBombarders,
            "<i class='fas fa-plane'></i> AVA": capaAVA,
            "<i class='fas fa-binoculars'></i> Comandament": capaComandament,
            "<i class='fas fa-user-shield'></i> Mossos d'Esquadra": capaMossos,
            "<i class='fas fa-paw'></i> Agents Rurals": capaRurals,
            "<i class='fas fa-water'></i> Salvament Marítim": capaSalvament,
            "<i class='fas fa-car-crash'></i> Servei Català de Trànsit": capaTransit,
        };

        // Control de capas colapsable
        const layersControl = L.control.layers(null, capesDisponibles, {
            collapsed: true,
            position: 'topright',
            autoZIndex: false
        }).addTo(map);

        // Asegurar que el control de capas esté colapsado en móviles
        if (window.innerWidth <= 768) {
            document.querySelector('.leaflet-control-layers').classList.remove('leaflet-control-layers-expanded');
        }

        const infoControl = L.Control.extend({
            options: { position: 'bottomleft' },
            onAdd: function () {
                const container = L.DomUtil.create('div');
                const icon = L.DomUtil.create('div', 'leaflet-control-info-toggle', container);
                icon.innerHTML = '<i class="fas fa-info-circle"></i> Ajuda';
                const infoBox = L.DomUtil.create('div', 'leaflet-control-info-box', container);
                infoBox.innerHTML = `
                    <div class="info-title">MAER CATALUNYA</div>
                    <div class="info-section">
                        <div class="info-section-title">Funcionament del sistema:</div>
                        <div>El Mapa de Mitjans Aeris d'Emergències de Catalunya mostra la localització i disposició de les bases d'aeronaus en el territori a dia d'avui.</div>
                    </div>

                    <div class="info-section">
                        <div class="info-section-title">Capes disponibles:</div>
                        <ul class="info-list">
                            <li><strong>SEM (HEMS)</strong>: Helicòpters del Servei d'Emergències Mèdiques</li>
                            <li><strong>Rescat Bombers</strong>: Helicòpters dels Bombers de la Generalitat dedicats al rescat</li>
                            <li><strong>Bombarders</strong>: Helicòpters bombarders (Combat d'incendis)</li>
                            <li><strong>AVA</strong>: Avions de Vigilància i Atac per a combat d'incendis</li>
                            <li><strong>Comandament</strong>: Helicòpters de comandament dels Bombers de la Generalitat</li>
                            <li><strong>Mossos d'Esquadra</strong>: Helicòpters dels Mossos d'Esquadra</li>
                            <li><strong>Agents Rurals</strong>: Helicòpters dels Agents Rurals</li>
                            <li><strong>Salvament Marítim</strong>: Helicòpters de rescat en medis aqüatics</li>
                            <li><strong>Servei Català de Trànsit</strong>: Mitjans utilitzats pel SCT</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <div class="info-section-title">Interacció:</div>
                        <ul class="info-list">
                            <li>Feu clic a qualsevol icona per veure'n més detalls</li>
                            <li>Activeu/desactiveu capes mitjançant el panell superior dret</li>
                            <li>Utilitzeu el zoom per navegar per diferents àrees</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <div class="info-section-title">Dades:</div>
                        <div>Les dades s'actualitzen periòdicament i NO són proveïdes per fonts oficials de la Generalitat</div>
                        <div class="creator-text">Creat per P.R.A.</div>`;

                L.DomEvent.disableClickPropagation(infoBox);
                L.DomEvent.on(infoBox, 'mousewheel', L.DomEvent.stopPropagation);

                L.DomEvent.on(icon, 'click', function (e) {
                    L.DomEvent.stopPropagation(e);
                    infoBox.style.display = infoBox.style.display === 'none' ? 'block' : 'none';
                });

                map.on('click', function() {
                    infoBox.style.display = 'none';
                });

                return container;
            }
        });

        map.addControl(new infoControl());

        // Ajustar controles al cambiar tamaño de pantalla
        function adjustForMobile() {
            const isMobile = window.innerWidth <= 768;

            // Ajustar controles de capas
            const layersControl = document.querySelector('.leaflet-control-layers');
            if (isMobile) {
                layersControl.classList.remove('leaflet-control-layers-expanded');
            }
        }

        window.addEventListener('resize', adjustForMobile);
        adjustForMobile();
    </script>
</body>
</html>
